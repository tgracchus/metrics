FROM openjdk:11-jdk as builder
WORKDIR /app
COPY . .
RUN ./gradlew bootDistZip
RUN unzip backend/build/distributions/backend-boot-0.0.1.zip -d /app

FROM openjdk:11-jdk as backend

COPY --from=builder /app/backend-boot-0.0.1 /app/backend-boot-0.0.1

ADD https://github.com/ufoscout/docker-compose-wait/releases/download/2.9.0/wait /wait
RUN chmod +x /wait

# specify default command
CMD /wait && /app/backend-boot-0.0.1/bin/backend
